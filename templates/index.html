<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>PE íŒŒì¼ ì •ì  ë¶„ì„ê¸°</title>
    <style>
        /* CSSëŠ” ìˆ˜ì •í•  í•„ìš”ê°€ ì—†ìœ¼ë¯€ë¡œ ê·¸ëŒ€ë¡œ ë‘¡ë‹ˆë‹¤. */
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif; 
            background-color: #f8f9fa; 
            color: #333; 
            display: flex; 
            justify-content: center; 
            align-items: flex-start;
            padding: 50px 20px;
            min-height: 100vh;
        }
        .container { 
            background: #fff; 
            border-radius: 8px; 
            box-shadow: 0 4px 12px rgba(0,0,0,0.05); 
            padding: 40px; 
            width: 100%;
            max-width: 800px; 
        }
        h1 { 
            text-align: center; 
            color: #0d6efd; 
            font-size: 2.2em;
            margin-bottom: 40px;
        }
        .drop-zone {
            border: none;
            padding: 30px 0;
            text-align: center;
            cursor: pointer;
            transition: background-color 0.2s ease;
            margin-bottom: 20px;
            border-radius: 8px;
        }
        .drop-zone.drag-over { background-color: #f0f6ff; }
        .drop-zone p { margin: 0; font-size: 1.2em; color: #0d6efd; }
        .drop-zone small { margin-top: 8px; display: block; color: #6c757d; }
        #file-upload { display: none; }
        .btn { 
            background: #0d6efd; 
            color: #fff; 
            padding: 15px 20px; 
            border: none; 
            border-radius: 5px; 
            cursor: pointer; 
            font-size: 1.1em; 
            width: 100%; 
            font-weight: bold;
            transition: background 0.3s; 
        }
        .btn:hover { background: #0b5ed7; }
        #results { margin-top: 40px; text-align: left; }
        #results h2 { border-bottom: 2px solid #eee; padding-bottom: 10px; font-size: 1.5em; color: #343a40;}
        .report-header { font-size: 1.2em; font-weight: bold; margin: 20px 0; }
        .report-header .filename { color: #0d6efd; }
        .no-threat { color: #008000; background: #e6f9e6; border-left: 5px solid #008000; padding: 15px; border-radius: 5px; }
        .threat-card { border: 1px solid #ddd; border-radius: 8px; margin-bottom: 15px; background: #fafafa; }
        .threat-card.High { border-left: 5px solid #d90429; }
        .threat-card.Medium { border-left: 5px solid #fca311; }
        .threat-card.Low { border-left: 5px solid #00b4d8; }
        .threat-header { padding: 15px; background: #f1f1f1; border-bottom: 1px solid #ddd; border-radius: 8px 8px 0 0; display: flex; justify-content: space-between; align-items: center; }
        .threat-header strong { font-size: 1.2em; }
        .threat-header .danger-tag { font-weight: bold; font-size: 0.9em; padding: 4px 12px; border-radius: 20px; color: #fff;}
        .threat-header .danger-tag.High { background-color: #d90429; }
        .threat-header .danger-tag.Medium { background-color: #fca311; color: #333; }
        .threat-header .danger-tag.Low { background-color: #00b4d8; }
        .threat-body { padding: 15px; }
        .threat-body p { margin: 10px 0; }
        .threat-body .label { font-weight: bold; color: #555; }
        .threat-body code { background: #eee; padding: 2px 5px; border-radius: 3px; color: #c7254e; word-break: break-all; }
    </style>
</head>
<body>

    <div class="container">
        <h1>PE íŒŒì¼ ì •ì  ë¶„ì„ê¸°</h1>
        
        <!-- â–¼â–¼â–¼ ë°”ë¡œ ì´ ë¶€ë¶„ì˜ ì˜¤íƒ€ë¥¼ ìˆ˜ì •í–ˆìŠµë‹ˆë‹¤! â–¼â–¼â–¼ -->
        <form action="/analyze" method="POST" enctype="multipart/form-data" id="upload-form">
            <label for="file-upload" class="drop-zone" id="drop-zone-label">
                <p>ë¶„ì„í•  EXE/DLL íŒŒì¼ì„ ì—¬ê¸°ì— ë“œë˜ê·¸ ì•¤ ë“œë</p> 
                <small>ë˜ëŠ” í´ë¦­í•˜ì—¬ íŒŒì¼ ì„ íƒ (ìµœëŒ€ 16MB)</small>
                <input type="file" name="file" id="file-upload" accept=".exe,.dll,.sys">
                <p id="file-name" style="font-weight: bold; margin-top: 15px; color: #333;"></p>
            </label>
            <button type="submit" class="btn">ë¶„ì„ ì‹œì‘</button>
        </form>     

        <!-- ë¶„ì„ ê²°ê³¼ í‘œì‹œ HTML êµ¬ì¡°ëŠ” ê·¸ëŒ€ë¡œ ì‚¬ìš© -->
        {% if results is not none %}
            <div id="results">
                <h2>ë¶„ì„ ê²°ê³¼</h2>
                <p class="report-header"><span class="filename">"{{ filename }}"</span> íŒŒì¼ ë¶„ì„ ì™„ë£Œ</p>

                {% if results|length == 0 %}
                    <div class="no-threat">
                        âœ… íŠ¹ì´í•œ ìœ„í˜‘ í–‰ìœ„ê°€ ë°œê²¬ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. (ì •ìƒ íŒŒì¼ ê°€ëŠ¥ì„± ë†’ìŒ)
                    </div>
                {% else %}
                    <p>ğŸš¨ ì´ <strong>{{ results|length }}</strong>ê°œì˜ ì ì¬ì  ìœ„í˜‘ í–‰ìœ„ê°€ íƒì§€ë˜ì—ˆìŠµë‹ˆë‹¤.</p>
                    
                    {% for threat in results %}
                        <div class="threat-card {{ threat.danger }}">
                            <div class="threat-header">
                                <strong>{{ threat.name }}</strong>
                                <span class="danger-tag {{ threat.danger }}">{{ threat.danger }}</span>
                            </div>
                            <div class="threat-body">
                                <p><span class="label">ì„¤ëª…:</span> {{ threat.description }}</p>
                                {% if threat.apis %}
                                <p><span class="label">ê·¼ê±° API:</span> <code>{{ threat.apis|join(', ') }}</code></p>
                                {% endif %}
                            </div>
                        </div>
                    {% endfor %}
                {% endif %}
            </div>
        {% endif %}
    </div>

    <!-- JavaScript ë¶€ë¶„ì€ ìˆ˜ì •í•  í•„ìš” ì—†ìŠµë‹ˆë‹¤. -->
    <script>
        const dropZone = document.getElementById('drop-zone-label');
        const fileInput = document.getElementById('file-upload');
        const fileNameDisplay = document.getElementById('file-name');
        const dropZoneText = dropZone.querySelector('p');
        const originalText = dropZoneText.textContent;

        dropZone.addEventListener('click', () => fileInput.click());
        
        fileInput.addEventListener('change', () => {
            if (fileInput.files.length > 0) {
                fileNameDisplay.textContent = `ì„ íƒëœ íŒŒì¼: ${fileInput.files[0].name}`;
            }
        });

        function preventDefaults(e) { e.preventDefault(); e.stopPropagation(); }
        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
            dropZone.addEventListener(eventName, preventDefaults, false);
        });
        ['dragenter', 'dragover'].forEach(eventName => {
            dropZone.addEventListener(eventName, () => dropZone.classList.add('drag-over'), false);
        });
        ['dragleave', 'drop'].forEach(eventName => {
            dropZone.addEventListener(eventName, () => dropZone.classList.remove('drag-over'), false);
        });
        dropZone.addEventListener('drop', (e) => {
            fileInput.files = e.dataTransfer.files;
            fileNameDisplay.textContent = `ì„ íƒëœ íŒŒì¼: ${fileInput.files[0].name}`;
        }, false);
    </script>

</body>
</html>